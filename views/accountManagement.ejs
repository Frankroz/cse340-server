<% if (title) { %>
<h1><%= title %></h1>
<% } else { %>
<h1>Account Management</h1>
<% } %> <% if (messages.error) { %>
<div class="notice notice-error"><%= messages.error %></div>
<% } %> <% if (locals.accountData) { %>

<h2>Welcome <%= locals.accountData.account_firstname %></h2>

<% if (locals.accountData.account_type === "Employee" ||
locals.accountData.account_type === "Admin") { %>
<div class="management-links">
  <h3 class="mt-4">Inventory Management</h3>
  <p>
    <a href="/inv" title="Access Inventory Management"
      >Access Inventory Management</a
    >
  </p>
</div>
<% } %>

<section class="account-details mt-6 p-4 border rounded shadow">
  <h3 class="text-xl font-bold mb-2">Account Details</h3>
  <p>
    <strong>Name:</strong> <%= locals.accountData.account_firstname %> <%=
    locals.accountData.account_lastname %>
  </p>
  <p><strong>Email:</strong> <%= locals.accountData.account_email %></p>
  <p><strong>Account Type:</strong> <%= locals.accountData.account_type %></p>
  <div class="management-links">
    <a
      href="/account/update/<%= locals.accountData.account_id %>"
      title="Update Account Information"
      >Update Account Information</a
    >
  </div>
</section>

<% if (locals.userComments && locals.userComments.length > 0) { %>
<section class="user-comments mt-6 p-4 border rounded shadow">
  <h3 class="text-xl font-bold mb-4">
    Your Published Comments (<%= locals.userComments.length %>)
  </h3>
  <table class="comments-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Comment</th>
        <th>Vehicle</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% locals.userComments.forEach(comment => { %>
      <tr>
        <td class="comment-date-cell">
          <%= new Date(comment.comment_date).toLocaleDateString('en-US', { year:
          'numeric', month: 'short', day: 'numeric' }) %>
        </td>
        <td class="comment-text-cell">
          <%= comment.comment_text.substring(0, 50) %>...
        </td>
        <td class="comment-vehicle-cell">
          <a
            href="/detail/<%= comment.inv_id %>"
            title="View <%= comment.inv_make %> <%= comment.inv_model %>"
          >
            <%= comment.inv_make %> <%= comment.inv_model %>
          </a>
        </td>
        <td class="comment-actions-cell">
          <a
            href="/comment/edit/<%= comment.comment_id %>"
            title="Edit this comment"
            class="action-button edit-button"
            >Edit</a
          >
          <a
            href="/comment/delete/<%= comment.comment_id %>"
            title="Delete this comment"
            class="action-button delete-button"
            >Delete</a
          >
        </td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</section>
<% } else { %>
<section class="user-comments mt-6 p-4 border rounded shadow">
  <h3 class="text-xl font-bold mb-2">Your Published Comments</h3>
  <p>You have not published any comments yet.</p>
</section>
<% } %>

<% } else { %>
<p>Account data is unavailable.</p>
<% } %>
